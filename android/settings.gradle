pluginManagement {
    def localPropertiesFile = new File(rootDir, "local.properties")
    def properties = new Properties()

    if (localPropertiesFile.exists()) {
        localPropertiesFile.withReader("UTF-8") { reader -> properties.load(reader) }
    }

    def flutterSdkPath = properties.getProperty("flutter.sdk")
    if (flutterSdkPath == null) {
        throw new Exception("Flutter SDK not set in local.properties")
    }

    settings.ext.set("flutterSdkPath", flutterSdkPath)

    includeBuild("${flutterSdkPath}/packages/flutter_tools/gradle")

    repositories {
        google()
        mavenCentral()
        gradlePluginPortal()
        // Flutter 官方 Maven 仓库：用于下载 flutter-gradle-plugin
        maven { url 'https://storage.googleapis.com/download.flutter.io' }
    }
}

dependencyResolutionManagement {
    repositoriesMode.set(RepositoriesMode.PREFER_SETTINGS)
    repositories {
        google()
        mavenCentral()
        gradlePluginPortal()
        // Flutter 官方 Maven 仓库：用于下载 engine AARs
        maven { url 'https://storage.googleapis.com/download.flutter.io' }

        // 本地 Flutter SDK 中的 engine artifacts（可选但推荐）
        maven { url uri("${settings.ext.flutterSdkPath}/bin/cache/artifacts/engine") }
    }
}

rootProject.name = "readky"
include(":app")
